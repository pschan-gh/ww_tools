<html>
<head>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js" integrity="sha384-ChfqqxuZUCnJSK3+MXmPNIyE6ZbWh2IMqE241rYiqJxyMiZ6OW/JmZQ5stwEULTy" crossorigin="anonymous"></script>

    <script src="matrix_generator.js"></script>
    <!-- <script src="wwmatrix.js"></script> -->

    <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        skipStartupTypeset: true,
        tex2jax: {
            inlineMath: [['$','$'], ['\\(','\\)']],
            processEnvironments: true,
            processEscapes: true,
            ignoreClass: "tex2jax_ignore"
        },
        MathML: {
            extensions: ["content-mathml.js"]
        },
        TeX: {
            equationNumbers: {autoNumber: "ams"},
            extensions: ["AMSmath.js"]
        }
    });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML" type="text/javascript"></script>

    <style>
    .hidden {
        display:none;
    }

    #math-field {
        font-size:2em;
    }
    #latex, #asciimath {
        font-family:courier;
        font-weight:bold;
    }
    table { table-layout: fixed; width:auto}
    td {
        font-family:serif;
        font-weight:bold;
        min-width:3em;
    }

    body {
        color:#555;
    }
</style>

</head>

<body style="width:90%;margin:10 auto;font-family:sans-serif">
    <h1>WeBWorK-Compatible Matrix Generator</h1>
    Use arrow keys on your keyword to expand columns/rows and to navigate within the matrix.
    <hr/>
    <div id="container" style="width:30em; margin:auto;padding-top:20px">
        <table id='matrix_table' class='table table-bordered matrix-field'>
            <tr>
                <td>0</td>
            </tr>
        </table>
        <hr/>
        rows: <span id='row_info'>1</span>
        cols: <span id='col_info'>1</span>
    </div>
    <hr/>
    <div id="report" style="margin: 50px 50px">
        <strong>WeBWorK</strong>
        <br/>
        <input type='text' id='matrix' readonly style="width:90%" onclick="selectText(this);"></input>
        <br/>
        <div class="hidden">
            octave: <span id='octave'></span>
        </div>
        <br/>
        <div class="hidden">
            latex: <span id='latex' class="cached_tex"></span>
        </div>
        <hr/>
        <div style="text-align:left">
            <strong>Preview</strong>
            <div style="width:90%" class='jax_preview'></div>
        </div>
    </div>


    <script>
      var me = new matrixEditor($('#container')[0], $('#report')[0],  $('#matrix')[0]);
      me.updateMatrix();
      // $('#row_info').text(me.curr.row);
      // $('#col_info').text(me.curr.col);
      $('.matrix-field tr:eq(' + me.curr.row + ') td:eq(' + me.curr.col + ')').attr('contenteditable', 'true')[0].focus();
      $('.matrix-field').keydown(function(e) {
          me.checkKey(e);
          if (e.keyCode === 37 || e.keyCode === 38 || e.keyCode === 39 || e.keyCode === 40) {
              let max_col = $('#matrix_table').find('tr').first().find('td').length;
              let max_row = $('#matrix_table').find('tr').length;
              $('#row_info').text(max_row);
              $('#col_info').text(max_col);
          }
	});

    function selectText(input) {
        input.focus();
        input.select();
    }
    </script>
</body>
